{"paragraphs":[{"text":"%md\n# Bienvenue sur NoteBook !\n\n\n### Ce NoteBook va vous permettre d'exécuter du code Python sur Spark et d'en afficher directement le résultat.\n\n\nSi vous ne connaissez pas **Zeppelin**, voici quelques astuces :\n* Tout ce qui est exécuté en amont, s'applique en aval.\n`Ex. je crée une var x = 4 ici, si je fais x+=1 dans le bloc suivant, j'aurai x=5`\n* Pour exécuter le contenu d'un bloc, vous pouvez utiliser le raccourci shift+enter\n* Vérifiez que \"%pyspark\" soit renseigné au début de chacun des blocs que vous exécutez.\n`En l'absence de %pyspark, le code est exécuté en Scala et non en Python.`","user":"anonymous","dateUpdated":"2025-07-25T11:54:39+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Bienvenue sur NoteBook !</h1>\n<h3>Ce NoteBook va vous permettre d'exécuter du code Python sur Spark et d'en afficher directement le résultat.</h3>\n<p>Si vous ne connaissez pas <strong>Zeppelin</strong>, voici quelques astuces :</p>\n<ul>\n<li>Tout ce qui est exécuté en amont, s'applique en aval.\n<br  /><code>Ex. je crée une var x = 4 ici, si je fais x+=1 dans le bloc suivant, j'aurai x=5</code></li>\n<li>Pour exécuter le contenu d'un bloc, vous pouvez utiliser le raccourci shift+enter</li>\n<li>Vérifiez que &ldquo;%pyspark&rdquo; soit renseigné au début de chacun des blocs que vous exécutez.\n<br  /><code>En l'absence de %pyspark, le code est exécuté en Scala et non en Python.</code></li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1601895439505_293360950","id":"20161211-125006_249248300","dateCreated":"2020-10-05T10:57:19+0000","dateStarted":"2025-07-25T11:54:39+0000","dateFinished":"2025-07-25T11:54:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:32754"},{"text":"%md\n\n### Les fonctions dont vous aurez besoin dans cet exercice :\nPour charger une collection de données (une liste de valeurs ici)\n`sc.parallelize([a,b,c,d,e...])`\n\nPour appliquer une transformation sur une collection :\n`rdd.map()`\n\nPour filtrer une collection :\n`rdd.filter()`\n\nPour récupérer un nombre n d'éléments de la collection :\n`rdd.take(n)`\n\nPour réduire les données en se basant sur la clé :\n`rdd.reduceByKey()`\n\n#### Des questions sur la syntaxe Python ? [Cliquez-ici](https://docs.python.org/3.4/contents.html)\n#### Des questions sur une fonction Spark ? [Cliquez-là](https://spark.apache.org/docs/2.0.0/api/python/index.html)","dateUpdated":"2020-10-05T10:57:19+0000","config":{"tableHide":false,"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Les fonctions dont vous aurez besoin dans cet exercice :</h3>\n<p>Pour charger une collection de données (une liste de valeurs ici)\n<br  /><code>sc.parallelize([a,b,c,d,e...])</code></p>\n<p>Pour appliquer une transformation sur une collection :\n<br  /><code>rdd.map()</code></p>\n<p>Pour filtrer une collection :\n<br  /><code>rdd.filter()</code></p>\n<p>Pour récupérer un nombre n d'éléments de la collection :\n<br  /><code>rdd.take(n)</code></p>\n<p>Pour réduire les données en se basant sur la clé :\n<br  /><code>rdd.reduceByKey()</code></p>\n<h4>Des questions sur la syntaxe Python ? <a href=\"https://docs.python.org/3.4/contents.html\">Cliquez-ici</a></h4>\n<h4>Des questions sur une fonction Spark ? <a href=\"https://spark.apache.org/docs/2.0.0/api/python/index.html\">Cliquez-là</a></h4>\n"}]},"apps":[],"jobName":"paragraph_1601895439505_293360950","id":"20161211-125818_521749041","dateCreated":"2020-10-05T10:57:19+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:32755"},{"text":"%pyspark\n# On charge une liste d entiers de 1 à 10\n# Q1 - Complétez le code suivant en renseignant la liste d'entiers à charger\nmaListe = sc.parallelize(list(range(1,11)))\n\n# Q2 - Affichez le contenu de la liste\nprint(maListe.take(10))\n","dateUpdated":"2020-10-05T10:57:19+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":[],"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n"}]},"apps":[],"jobName":"paragraph_1601895439506_294515197","id":"20161205-135005_1080241990","dateCreated":"2020-10-05T10:57:19+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:32756"},{"text":"%pyspark\n# Q3 - Multiplier chacune des valeurs de la collection par 10\nmaListeMult = maListe.map(lambda number: number*10)\n\n# Affichez si vous le souhaitez les valeurs de la nouvelle collecte\nprint(maListeMult.take(10))\n\n# Q4 - Filtrer les valeurs de la liste pour ne conserver que les valeurs inférieures à 100\nmaListeM100 = maListeMult.filter(lambda inf100: inf100 < 100)\n\n# Affichez les valeurs de la liste pour vérifier le résultat\nprint(maListeM100.take(10))\n","dateUpdated":"2020-10-05T10:57:19+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[10, 20, 30, 40, 50, 60, 70, 80, 90, 100]\n[10, 20, 30, 40, 50, 60, 70, 80, 90]\n"}]},"apps":[],"jobName":"paragraph_1601895439506_294515197","id":"20161205-135045_152921429","dateCreated":"2020-10-05T10:57:19+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:32757"},{"text":"%md\n### Pour créer une fonction en python, on procède de la manière suivante :\n`def nomDeLaFonction(arguments) :`  \n`   return valeur`","dateUpdated":"2020-10-05T10:57:19+0000","config":{"tableHide":false,"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Pour créer une fonction en python, on procède de la manière suivante :</h3>\n<p><code>def nomDeLaFonction(arguments) :</code>\n<br  /><code>return valeur</code></p>\n"}]},"apps":[],"jobName":"paragraph_1601895439506_294515197","id":"20161211-130332_1063207427","dateCreated":"2020-10-05T10:57:19+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:32758"},{"text":"%pyspark\n# Q5 - Créez la fonction sup50 qui prend en argument x\n# et qui retourne la chaine \"sup50\" si x est > 50\n#                 la chaine \"inf50\" sinon\ndef sup50(x) :\n    return  \"sup50\" if x>50 else \"inf50\"\n","dateUpdated":"2020-10-05T10:57:19+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":[],"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1601895439506_294515197","id":"20161205-135128_1257056338","dateCreated":"2020-10-05T10:57:19+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:32759"},{"text":"%pyspark\n# Q6 - Appliquez la fonction précedemment créée\n# Afin de transformer votre liste d'entiers n en liste de tuples\n# (categorie,entier) avec categorie = sup50 et ou inf50 selon l'entier\nmaListeCat = maListeM100.map(lambda entier: (sup50(entier), entier))\n\n# Affichez les valeurs de votre liste pour vérifier le résultat\nprint(maListeCat.take(10))","dateUpdated":"2020-10-05T10:57:19+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('inf50', 10), ('inf50', 20), ('inf50', 30), ('inf50', 40), ('inf50', 50), ('sup50', 60), ('sup50', 70), ('sup50', 80), ('sup50', 90)]\n"}]},"apps":[],"jobName":"paragraph_1601895439506_294515197","id":"20161205-135412_454475138","dateCreated":"2020-10-05T10:57:19+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:32760"},{"text":"%md\n`# Question bonus !`\n","dateUpdated":"2020-10-05T10:57:19+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><code># Question bonus !</code></p>\n"}]},"apps":[],"jobName":"paragraph_1601895439506_294515197","id":"20161212-213454_1088462399","dateCreated":"2020-10-05T10:57:19+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:32761"},{"text":"%pyspark\n# Q7 - Utilisez la fonction reduceByKey pour sommer les valeurs de chaque catégorie\nparCategorie = maListeCat.reduceByKey(lambda x,y: x+y)\n\n# Affichez le résultat\nprint(parCategorie.take(10))","dateUpdated":"2020-10-05T10:57:19+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('inf50', 150), ('sup50', 300)]\n"}]},"apps":[],"jobName":"paragraph_1601895439507_294130448","id":"20161205-135532_1586502010","dateCreated":"2020-10-05T10:57:19+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:32762"},{"text":"%pyspark\n","dateUpdated":"2020-10-05T10:57:19+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":[],"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1601895439507_294130448","id":"20161205-135755_1466222846","dateCreated":"2020-10-05T10:57:19+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:32763"}],"name":"2 - Exercices/Exercice 1 - Pyspark","id":"2FPSD1MHK","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}