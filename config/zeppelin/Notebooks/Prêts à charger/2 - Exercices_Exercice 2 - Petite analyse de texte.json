{"paragraphs":[{"text":"%md\n### Bienvenue dans cet exercice\n\nFini de parler de **collections**, on sait maintenant ce qu'est un **RDD**.\n\n#### Voyons comment aller un peu plus loin !\n\nDans cet exercice, nous allons repartir de notre corpus de texte et calculer la fréquence des mots\nL'objectif est réaliser la fameuse application wordCount(), le hello world de Spark","user":"anonymous","dateUpdated":"2025-07-25T11:55:26+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Bienvenue dans cet exercice</h3>\n<p>Fini de parler de <strong>collections</strong>, on sait maintenant ce qu'est un <strong>RDD</strong>.</p>\n<h4>Voyons comment aller un peu plus loin !</h4>\n<p>Dans cet exercice, nous allons repartir de notre corpus de texte et calculer la fréquence des mots\n<br  />L'objectif est réaliser la fameuse application wordCount(), le hello world de Spark</p>\n"}]},"apps":[],"jobName":"paragraph_1601895446982_1897779188","id":"20161212-221926_525918632","dateCreated":"2020-10-05T10:57:26+0000","dateStarted":"2025-07-25T11:55:26+0000","dateFinished":"2025-07-25T11:55:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:36332"},{"text":"%md\n\n### Les fonctions dont vous aurez besoin dans cet exercice :\nPour charger un fichier texte dans un RDD\n`sc.textFile('cheminDuFichier')`\n\nPour compter le nombre d'éléments dans un RDD\n`rdd.count()`\n\nPour appliquer une transformation sur une collection :\n`rdd.map()`\n\nPour filtrer une collection :\n`rdd.filter()`\n\nPour récupérer un nombre n d'éléments de la collection :\n`rdd.take(n)`\n\nSimilaire à map mais chaque item du RDD source peut être transformé en 0 ou plusieurs items ;\nRetourne une séquence (Seq) plutôt qu’un seul item.\n`rdd.flatMap()`\n\n#### Des questions sur la syntaxe Python ? [Cliquez-ici](https://docs.python.org/3.4/contents.html)\n#### Des questions sur une fonction Spark ? [Cliquez-là](https://spark.apache.org/docs/2.0.0/api/python/index.html)","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Les fonctions dont vous aurez besoin dans cet exercice :</h3>\n<p>Pour charger un fichier texte dans un RDD<br/><code>sc.textFile(&#39;cheminDuFichier&#39;)</code></p>\n<p>Pour compter le nombre d&rsquo;éléments dans un RDD<br/><code>rdd.count()</code></p>\n<p>Pour appliquer une transformation sur une collection :<br/><code>rdd.map()</code></p>\n<p>Pour filtrer une collection :<br/><code>rdd.filter()</code></p>\n<p>Pour récupérer un nombre n d&rsquo;éléments de la collection :<br/><code>rdd.take(n)</code></p>\n<p>Similaire à map mais chaque item du RDD source peut être transformé en 0 ou plusieurs items ;<br/>Retourne une séquence (Seq) plutôt qu’un seul item.<br/><code>rdd.flatMap()</code></p>\n<h4>Des questions sur la syntaxe Python ? <a href=\"https://docs.python.org/3.4/contents.html\">Cliquez-ici</a></h4>\n<h4>Des questions sur une fonction Spark ? <a href=\"https://spark.apache.org/docs/2.0.0/api/python/index.html\">Cliquez-là</a></h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1601895446983_1897394439","id":"20180403-122113_381116949","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36333"},{"text":"%sh\n\n# Des fichiers de données sont présent sous le chemin \"/data/data\", nous allons ici utiliser le dossier \"texte\" comportant un corpus.\nls /data/data","dateUpdated":"2020-10-05T10:57:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1601895446983_1897394439","id":"20180403-122307_2057339113","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36334"},{"text":"%pyspark\n# Q1 - Remplissage du RDD avec un corpus d'articles extraits d'un site très intéressant...\narticles = sc.textFile(\"/data/data/texte/*\")\n","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1601895446983_1897394439","id":"20161205-165731_1838117287","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36335"},{"text":"%pyspark\n\n# Q2 - Comptage du nombre de ligne collectees dans les articles\nprint(\"Count = \" + articles.count)\n\n# Q3 - Afficher les 10 premieres lignes du RDD\n\nprint(articles.show())\n","dateUpdated":"2020-10-05T10:57:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1601895446983_1897394439","id":"20180403-122343_1630011501","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36336"},{"text":"%pyspark\n#Q2 - Eclatez le texte en mots\n# Astuce : La fonction split() en Python devrait vous être utile...\nmots = articles.flatMap(lambda ligne: ligne.split(\" \"))\n\n\n# On affiche le nombre de mots du RDD pour se rassurer\nprint(mots.count())","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"26631\n"}]},"apps":[],"jobName":"paragraph_1601895446984_1895470694","id":"20161205-165800_1691212023","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36337"},{"text":"%md\n\nL'objectif est de pouvoir calculer la fréquence d'apparition des mots\nPour cela, on va créer pour chaque mot un **tuple(mot, 1)** afin d'associer à chaque mot la valeur 1\nIl nous suffira de sommer cette valeur en regroupant les résultat par mots pour avoir la fréquence d'un mot dans le texte\n`En créant les mots (test,1) (test,1) (test,1) on pourra sommer par clé (test) les valeurs (1+1+1) et avoir (test,3)`","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>L'objectif est de pouvoir calculer la fréquence d'apparition des mots\n<br  />Pour cela, on va créer pour chaque mot un <strong>tuple(mot, 1)</strong> afin d'associer à chaque mot la valeur 1\n<br  />Il nous suffira de sommer cette valeur en regroupant les résultat par mots pour avoir la fréquence d'un mot dans le texte\n<br  /><code>En créant les mots (test,1) (test,1) (test,1) on pourra sommer par clé (test) les valeurs (1+1+1) et avoir (test,3)</code></p>\n"}]},"apps":[],"jobName":"paragraph_1601895446984_1895470694","id":"20161212-222737_2135188719","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36338"},{"text":"%pyspark\n# Q3 - Commençons par transformer nos mots en tuples de la forme (mot,1)\nmotsKV = mots.map(lambda mot: (mot,1))\n\n# Affichez les dix premiers couples (mot,1) du RDD\nprint(motsKV.take(10))","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('ACQUISITION', 1), ('Contact', 1), ('presse', 1), (':', 1), ('CLS', 1), ('Amélie', 1), ('PROUST', 1), ('aproust@cls.fr', 1), ('Tel', 1), (':', 1)]\n"}]},"apps":[],"jobName":"paragraph_1601895446984_1895470694","id":"20161205-165853_793131852","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36339"},{"text":"%md\nMaintenant que l'on a nos tuples (mot,1) il suffit d'agréger les données par mots en effectuant la somme de leurs valeurs\nOn peut pour cela utiliser la fonction reduceByKey() en spécifiant que l'on souhaite faire la somme de chaque valeur successive pour un mot donné\n \n`Il faut créer une fonction lambda de la forme \"Pour les valeurs x et la suivante y, ajoutez x + y\"` ","dateUpdated":"2020-10-05T10:57:26+0000","config":{"tableHide":false,"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Maintenant que l&rsquo;on a nos tuples (mot,1) il suffit d&rsquo;agréger les données par mots en effectuant la somme de leurs valeurs<br/>On peut pour cela utiliser la fonction reduceByKey() en spécifiant que l&rsquo;on souhaite faire la somme de chaque valeur successive pour un mot donné</p>\n<p><code>Il faut créer une fonction lambda de la forme &quot;Pour les valeurs x et la suivante y, ajoutez x + y&quot;</code></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1601895446984_1895470694","id":"20161212-223330_473208510","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36340"},{"text":"%pyspark\n\n# Q4 - Utilisez le reduceByKey() pour faire la somme par clé de la valeur en cours + la valeur suivante\nmotsCount = motsKV.reduceByKey(lambda x,y: x+y)\n\n# Affichez les dix premiers résultats du RDD\nprint(motsCount.take(10))\n\n# Êtes-vous capable de donner le mot le plus fréquent ? \n\n# >> Les mots ne sont pas triés","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('', 55), ('congelé.', 1), ('(Collecte', 1), ('BOST,', 1), ('presse.cnes.fr', 1), ('pour', 203), ('d’analyse', 2), ('sud-est', 1), ('bvw@esa.int', 1), ('000', 40)]\n"}]},"apps":[],"jobName":"paragraph_1601895446984_1895470694","id":"20161205-165959_6590696","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36341"},{"text":"%pyspark\n# Q5- En vous aidant de l'API (la documentation fournie en début de Notebook)\n# Quelle fonction permettrait d'afficher les mots les plus fréquents ? \n\n# Q6 - Appliquez cette fonction\nmotsCountS = motsCount.sortBy(lambda x: x[1], False)\n\n# Récupérez les dix premiers mots du RDD nouvellement créé\nmotsCountS.take(10)\n","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('de', 1693), ('et', 724), ('des', 694), ('la', 681), ('les', 534), ('à', 463), ('du', 383), ('le', 364), ('en', 352), ('CLS', 275)]\n"}]},"apps":[],"jobName":"paragraph_1601895446985_1895085946","id":"20161205-170053_1520479191","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36342"},{"text":"%md\n`# Question bonus !`","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><code># Question bonus !</code></p>\n"}]},"apps":[],"jobName":"paragraph_1601895446985_1895085946","id":"20161212-223943_2022139194","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36343"},{"text":"%pyspark\n# Pour aller plus loin...\n# Le classement des mots n'est pas vraiment utile puisque ce sont des mots courants\n# et qui n'apportent peu de valeur aux articles qui remontent en premier\n\n# Nous allons travailler à les éliminer rapidement\n\n# Q8- Chargez dans un RDD \"stop\" le fichier de stopwords\nstop = sc.textFile(\"/data/data/stopwords_fr.txt\")\n\n# Q8 bis - Transformez ce RDD en une liste de mots en récupérant son contenu\nstop = stop.collect()","dateUpdated":"2020-10-05T10:57:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":[],"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1601895446985_1895085946","id":"20161205-170406_1130098628","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36344"},{"text":"%pyspark\n# Partez du RDD ne contenant que les mots des articles (il se nomme normalement mots)\n\n# Q9- Transformez tous les mots en mots en minuscules \nmotsFiltmin = mots.map(lambda word: word.lower())\nprint(motsFiltmin.take(10))","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['acquisition', 'contact', 'presse', ':', 'cls', 'amélie', 'proust', 'aproust@cls.fr', 'tel', ':']\n"}]},"apps":[],"jobName":"paragraph_1601895446985_1895085946","id":"20161205-171430_1593669777","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36345"},{"text":"%pyspark\n# Q10- Filtrez pour éliminer les mots présents dans la liste de stopwords\n# Astuce : Pour vérifier qu'un terme n'est pas dans une liste en Python :\"term not in list\"\nmotsFiltSW = motsFiltmin.filter(lambda word: word not in stop)\nprint(motsFiltSW.take(10))","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['acquisition', 'contact', 'presse', ':', 'cls', 'amélie', 'proust', 'aproust@cls.fr', ':', '+33']\n"}]},"apps":[],"jobName":"paragraph_1601895446985_1895085946","id":"20170807-130339_1978085473","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36346"},{"text":"%pyspark\n# Q11 - Filtrez pour ne récupérer que les mots dont la longueur est supérieure à 2\nmotsFiltLong = motsFiltSW.filter(lambda word: len(word) > 2)\n\n# Affichez les dix premiers mots de votre RDD pour vérifier qu'ils satisfont les exigences\nprint(motsFiltLong.take(10))","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['acquisition', 'contact', 'presse', 'cls', 'amélie', 'proust', 'aproust@cls.fr', '+33', 'mob', 'cls']\n"}]},"apps":[],"jobName":"paragraph_1601895446985_1895085946","id":"20170807-130349_1410760742","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36347"},{"text":"%pyspark\n# Recréez les tuples et calculez à nouveau le classement des mots par fréquence\n# Normalement vous devriez savoir enchainer toutes les fonctions pour faire le wordCount\nmotsCount = motsFiltLong.map(lambda word : (word,1)).reduceByKey(lambda x,y: x+y).sortBy(lambda tuple: tuple[1], False)\n\n# Affichez les 20 premiers mots !\nmotsCount.take(20)","dateUpdated":"2020-10-05T10:57:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('cls', 275), ('données', 144), ('niveau', 67), ('grâce', 67), ('réchauffement', 66), ('ressources', 59), ('cls,', 59), ('satellites', 57), ('également', 49), ('gestion', 47), ('surveillance', 46), ('mer', 43), ('climatique', 43), ('pêche', 43), ('système', 43), ('radar', 42), ('000', 40), ('services', 40), ('groupe', 38), ('argos', 38)]\n"}]},"apps":[],"jobName":"paragraph_1601895446986_1896240192","id":"20161205-171631_1889580669","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36348"},{"text":"%pyspark\n","dateUpdated":"2020-10-05T10:57:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":[],"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1601895446986_1896240192","id":"20161205-173624_1424950290","dateCreated":"2020-10-05T10:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:36349"}],"name":"2 - Exercices/Exercice 2 - Petite analyse de texte","id":"2FN4SRKKA","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}