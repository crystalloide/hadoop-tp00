{"paragraphs":[{"text":"%md\n###Bienvenue dans ce troisième exercice\n\nCet exercice est très court et a deux objectifs :\n`Vous montrer l'importance du cache, et vous donner un exemple sur l'importance de l'associativité dans les opérations sur les RDD`\n","dateUpdated":"2020-10-05T10:57:46+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Bienvenue dans ce troisième exercice</h3>\n<p>Cet exercice est très court et a deux objectifs :\n<br  /><code>Vous montrer l'importance du cache, et vous donner un exemple sur l'importance de l'associativité dans les opérations sur les RDD</code></p>\n"}]},"apps":[],"jobName":"paragraph_1601895466167_1378999753","id":"20161212-224827_877175887","dateCreated":"2020-10-05T10:57:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:48524"},{"text":"%pyspark\n# Q1 - Chargez une liste d'entiers de 1 à 8 dans un RDD.\nk = sc.parallelize(list(range(1,9)))\n","dateUpdated":"2020-10-05T10:57:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":[],"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1601895466167_1378999753","id":"20161206-090806_333409396","dateCreated":"2020-10-05T10:57:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:48525"},{"text":"%pyspark\n# On va importer la librairie random pour faire notre test\nimport random\n\n# Q2 - Affichez les dix premiers entiers de votre liste k\nprint(k.take(10))\n\n# Q3 - Créez un RDD nommé rdd, basé sur k, qui pour chaque élément de k\n# lui ajoute un nombre aléatoire entre 0 et 5\n# Astuce : pour un nombre aléatoire entre 1 et 10 : random.randint(1,10) \nrdd = k.map(lambda nombre: nombre + random.randint(0,5))","dateUpdated":"2020-10-05T10:57:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4, 5, 6, 7, 8]\n"}]},"apps":[],"jobName":"paragraph_1601895466168_1377076008","id":"20161206-090823_335753383","dateCreated":"2020-10-05T10:57:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:48526"},{"text":"%pyspark\n\n# Q4 - Affichez une première fois le contenu du RDD \"rdd\"\nprint(rdd.take(10))\n\n# Q5 - Affichez une seconde fois le contenu du RDD \"rdd\", que remarquez-vous ?\nprint(rdd.take(10))","dateUpdated":"2020-10-05T10:57:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 7, 7, 8, 9, 10, 8, 9]\n[2, 2, 7, 9, 7, 8, 8, 12]\n"}]},"apps":[],"jobName":"paragraph_1601895466168_1377076008","id":"20161212-225532_79008625","dateCreated":"2020-10-05T10:57:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:48527"},{"text":"%pyspark\n\n\n# Q6 - Mettez le RDD \"rdd\" en cache\nrdd.cache()\n\n# Q7 - Affichez une première fois le contenu du rdd \"rdd\"\nprint(rdd.take(10))\n\n# Q8 - Affichez une seconde fois le contenu du rdd \"rdd\", que remarquez-vous ?\nprint(rdd.take(10))","dateUpdated":"2020-10-05T10:57:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[3, 6, 5, 5, 8, 11, 10, 13]\n[3, 6, 5, 5, 8, 11, 10, 13]\n"}]},"apps":[],"jobName":"paragraph_1601895466168_1377076008","id":"20161212-225545_1251607430","dateCreated":"2020-10-05T10:57:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:48528"},{"text":"%md\nLorsque l'on créée un RDD avec sc.parallelize, il est possible de spécifier le nombre de partitions souhaité.\n`sc.parallelize([Ma liste],5) découpera ma liste en 5 partitions.`","dateUpdated":"2020-10-05T10:57:46+0000","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Lorsque l'on créée un RDD avec sc.parallelize, il est possible de spécifier le nombre de partitions souhaité.\n<br  /><code>sc.parallelize([Ma liste],5) découpera ma liste en 5 partitions.</code></p>\n"}]},"apps":[],"jobName":"paragraph_1601895466168_1377076008","id":"20161212-225615_2120680795","dateCreated":"2020-10-05T10:57:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:48529"},{"text":"%pyspark\n# Q9 - Créez un rdd k2 à partir d'une liste de 1 à 8 sur 3 partitions\nk2 = sc.parallelize(list(range(1,9)), 3)\n\n# Q9 -bis Créez un rdd k3 à partir d'une liste de 1 à 8 sur 6 partitions\nk3 = sc.parallelize(list(range(1,9)), 6)\n\n# Q10 - Affichez le contenu des deux RDD\nprint(k2.take(10))\nprint(k3.take(10))","dateUpdated":"2020-10-05T10:57:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 3, 4, 5, 6, 7, 8]\n[1, 2, 3, 4, 5, 6, 7, 8]\n"}]},"apps":[],"jobName":"paragraph_1601895466169_1376691260","id":"20161206-090838_1949444374","dateCreated":"2020-10-05T10:57:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:48530"},{"text":"%pyspark\n\ndef div(x,y):\n    return x/y\n\n# Q11 - Executez un reduce, en divisant chaque élément de la liste par l'élément suivant sur k2\nres2 = k2.reduce(div)\n\n# Q11 bis - Même chose sur k3\nres3 = k3.reduce(div)\n\n\n# Q12 - Affichez le résultat res2 et res3\nprint(res2)\nprint(res3)","dateUpdated":"2020-10-05T10:57:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"44.8\n0.025396825396825397\n"}]},"apps":[],"jobName":"paragraph_1601895466169_1376691260","id":"20161212-174222_1795332457","dateCreated":"2020-10-05T10:57:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:48531"},{"text":"%pyspark\n# Q13 - Il est possible de réduire le nombre de partition avec la méthode \n# coalesce(n) avec n le nombre de partitions\n# Complétez le reduce avec la division d'un l'élément de la liste par son successeur\n# (identique Q11)\nprint(k2.coalesce(1).reduce(div))\nprint(k3.coalesce(1).reduce(div))","dateUpdated":"2020-10-05T10:57:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{},"map":{"baseMapType":"Streets","isOnline":true,"pinCols":[]}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2.48015873015873e-05\n2.48015873015873e-05\n"}]},"apps":[],"jobName":"paragraph_1601895466169_1376691260","id":"20161212-230252_1931353879","dateCreated":"2020-10-05T10:57:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:48532"},{"text":"%pyspark\n","dateUpdated":"2020-10-05T10:57:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1601895466169_1376691260","id":"20170911-082847_1046222673","dateCreated":"2020-10-05T10:57:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:48533"}],"name":"2 - Exercices/Exercice 7 - La mise en cache","id":"2FKFXZFP8","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}